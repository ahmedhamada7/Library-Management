<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="action_oracle_table_selector" model="ir.actions.act_window">
        <field name="name">Select Oracle Table</field>
        <field name="res_model">oracle.table.selector</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
    <record id="view_oracle_connector_tree" model="ir.ui.view">
        <field name="name">oracle_connector_list</field>
        <field name="model">oracle.connector</field>
        <field name="arch" type="xml">
            <list string="Oracle Connections"
                  decoration-success="connection_status == 'success'"
                  decoration-danger="connection_status == 'failed'"
                  decoration-muted="connection_status == 'not_tested'">
                <field name="name"/>
                <field name="connection_string"/>
                <field name="username"/>
                <field name="connection_status" widget="badge"/>
                <field name="last_connection_test"/>
                <field name="active" widget="boolean_toggle"/>
            </list>
        </field>
    </record>
    <record id="view_oracle_connector_form" model="ir.ui.view">
        <field name="name">oracle.connector.form</field>
        <field name="model">oracle.connector</field>
        <field name="arch" type="xml">
            <form string="Oracle Connection">
                <header>
                    <button name="test_connection"
                            string="Test Connection"
                            type="object"
                            class="btn-primary"/>
                    <button name="%(action_oracle_table_selector)d"
                            string="Fetch Data"
                            type="action"
                            class="btn-success"
                            context="{'default_connector_id': id}"
                            invisible="connection_status != 'success'"/>
                    <field name="connection_status" widget="statusbar"/>
                </header>

                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="test_connection"
                                type="object"
                                class="oe_stat_button"
                                icon="fa-database">
                            <div class="o_stat_info">
                                <span class="o_stat_text">Test Connection</span>
                            </div>
                        </button>
                        <button name="%(action_oracle_table_selector)d"
                                type="action"
                                class="oe_stat_button"
                                icon="fa-table"
                                context="{'default_connector_id': id}">
                            <div class="o_stat_info">
                                <span class="o_stat_text">Fetch Table Data</span>
                            </div>
                        </button>
                    </div>

                    <div class="oe_title">
                        <label for="name"/>
                        <h1>
                            <field name="name" placeholder="Enter connection name..."/>
                        </h1>
                    </div>

                    <group>
                        <group string="Connection Details">
                            <field name="host" placeholder="192.168.0.194"/>
                            <field name="port" placeholder="1521"/>
                            <field name="service_name" placeholder="TEST"/>
                            <field name="connection_string" readonly="1"/>
                        </group>
                        <group string="Credentials">
                            <field name="username" placeholder="APPS"/>
                            <field name="password" password="True"/>
                            <field name="active"/>
                        </group>
                    </group>

                    <group string="Connection Status">
                        <field name="last_connection_test" readonly="1"/>
                    </group>

<!--                    <notebook>-->
<!--                        <page string="Notes">-->
<!--                            <div class="alert alert-info" role="alert">-->
<!--                                <p>-->
<!--                                    <strong>Note:</strong>-->
<!--                                </p>-->
<!--                                <p>Ensure oracledb Python library is installed on the server.</p>-->
<!--                                <p>Use:-->
<!--                                    <code>pip install oracledb</code>-->
<!--                                </p>-->
<!--                            </div>-->
<!--                        </page>-->
<!--                    </notebook>-->
                </sheet>
            </form>
        </field>
    </record>
    <record id="view_oracle_table_selector_form" model="ir.ui.view">
        <field name="name">oracle.table.selector.form</field>
        <field name="model">oracle.table.selector</field>
        <field name="arch" type="xml">
            <form string="Select Oracle Table">
                <group>
                    <field name="connector_id" readonly="1"/>
                    <field name="table_name" placeholder="مثال: APPS.XX_AR_CUSTOMERS"/>
                </group>
                <footer>
                    <button name="action_fetch_data" string="Fetch Data &amp; Process" type="object"
                            class="btn-primary"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>



    <record id="action_oracle_connector" model="ir.actions.act_window">
        <field name="name">Oracle Connections</field>
        <field name="res_model">oracle.connector</field>
        <field name="view_mode">list,form</field>
    </record>

    <menuitem
            id="menu_oracle_main"
            name="Oracle Integration"
            sequence="100"
    />

    <menuitem
            id="menu_oracle_connections"
            name="Connections"
            parent="menu_oracle_main"
            action="action_oracle_connector"
            sequence="10"
    />
    <!-- List View -->



    <record id="action_oracle_connector" model="ir.actions.act_window">
        <field name="name">Oracle Connections</field>
        <field name="res_model">oracle.connector</field>
        <field name="view_mode">list,form</field>
    </record>

    <menuitem
            id="menu_oracle_main"
            name="Oracle Integration"
            sequence="100"
    />

    <menuitem
            id="menu_oracle_connections"
            name="Connections"
            parent="menu_oracle_main"
            action="action_oracle_connector"
            sequence="10"
    />


    <!-- Oracle Data Preview Tree View -->
    <record id="view_oracle_data_preview_tree" model="ir.ui.view">
        <field name="name">oracle.data.preview.tree</field>
        <field name="model">oracle.data.preview</field>
        <field name="arch" type="xml">
            <list string="Oracle Data Preview">
                <field name="row_number"/>
                <field name="data_json" widget="text"/>
            </list>
        </field>
    </record>

    <!-- Oracle Data Preview Form View -->
    <record id="view_oracle_data_preview_form" model="ir.ui.view">
        <field name="name">oracle.data.preview.form</field>
        <field name="model">oracle.data.preview</field>
        <field name="arch" type="xml">
            <form string="Oracle Data Details">
                <sheet>
                    <group>
                        <field name="row_number" readonly="1"/>
                        <field name="data_json" widget="textarea" readonly="1" nolabel="1"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action for Data Preview -->
    <record id="action_oracle_data_preview" model="ir.actions.act_window">
        <field name="name">Oracle Data Preview</field>
        <field name="res_model">oracle.data.preview</field>
        <field name="view_mode">list,form</field>
        <field name="target">current</field>
    </record>

    <!--    <menuitem-->
    <!--            id="menu_oracle_connections"-->
    <!--            name="Preview"-->
    <!--            parent="menu_oracle_main"-->
    <!--            action="action_oracle_data_preview"-->
    <!--            sequence="10"-->
    <!--    />-->

</odoo>
